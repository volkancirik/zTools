{% load url from future %}

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>


<head>

    {% block baseHead %}

    {% endblock %}
     <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
    <!--
    <script src="http://code.jquery.com/ui/1.8.18/jquery-ui.min.js" type="text/javascript"></script>
    <script src="http://jquery-ui.googlecode.com/svn/tags/latest/external/jquery.bgiframe-2.1.2.js" type="text/javascript"></script>
    <script src="http://jquery-ui.googlecode.com/svn/tags/latest/ui/minified/i18n/jquery-ui-i18n.min.js" type="text/javascript"></script>
-->
    <link rel="stylesheet" href="/static/css/ui-lightness/jquery-ui-1.8.18.custom.css" type="text/css" media="all" />
    <script type="text/javascript" src="/static/js/jquery-ui-1.8.18.custom.min.js"></script>
    <script>
       $(function() {
               $( "#dialog:ui-dialog" ).dialog( "destroy" );

               var keyword = $( "#keyword" ),
                   allFields = $( [] ).add( keyword ),
                   tips = $( ".validateTips" );

               function updateTips( t ) {
                   tips
                       .text( t )
                       .addClass( "ui-state-highlight" );
                   setTimeout(function() {
                       tips.removeClass( "ui-state-highlight", 1500 );
                   }, 500 );
               }

               function checkLength( o, n, min, max ) {
                   if ( o.val().length > max || o.val().length < min ) {
                       o.addClass( "ui-state-error" );
                       updateTips( "Length of " + n + " must be between " +
                           min + " and " + max + "." );
                       return false;
                   } else {
                       return true;
                   }
               }

               function checkRegexp( o, regexp, n ) {
                   if ( !( regexp.test( o.val() ) ) ) {
                       o.addClass( "ui-state-error" );
                       updateTips( n );
                       return false;
                   } else {
                       return true;
                   }
               }

               $( "#dialog-form" ).dialog({
                   autoOpen: false,
                   height: 200,
                   width: 200,
//                   backgroundColor: #808080,
                   modal: true,
                   buttons: {
                       "Search": function() {
                           var bValid = true;
                           allFields.removeClass( "ui-state-error" );

                           bValid = bValid && checkLength( keyword, "username", 2, 16 );

                           bValid = bValid && checkRegexp( keyword, /^[a-z]([0-9a-z_])+$/i, "Keyword may consist of a-z, 0-9, underscores, begin with a letter." );

                           if ( bValid ) {
                               document.getElementById('searchForm_1_keyword').value =  keyword.val();
                               //document.getElementById('searchForm').submit();
//                               $("#searchForm_1_keyword").value = keyword.val();
                               $('#searchForm').submit();
//                               	$( "#testDiv" ).append( "<tr>" +
//							    "<td>" + keyword.val() + "</td>" +
//						        "</tr>" );
//
//                                 alert(keyword.val());
                              $( this ).dialog( "close" );
//                                var args = { type:"POST", url:"/orders/", keyword:keyword.val(), columnd_name:'supplier_name' };
//                                $.ajax(args);
                           }
                       },
                       Cancel: function() {
                           $( this ).dialog( "close" );
                       }
                   },
                   close: function() {
                       allFields.val( "" ).removeClass( "ui-state-error" );
                   }
               });


           });
 function countCheckboxes(){
        var inputElems = document.getElementsByTagName("input"),
        count = 0;
        for (var i=0; i<inputElems.length; i++){
          if (inputElems[i].type === "checkbox" && inputElems[i].checked === true){

            count++;
            }
          }
          document.getElementById('numberofchecked').value= count;
        }

function openForm(ID){
       if ($("#searchForm_"+ID).is(":hidden")){
          $("#searchForm_"+ID).slideDown("slow");
       }
       else{
           $("#searchForm_"+ID).slideUp("slow");
       }
}	$(function() {
		// a workaround for a flaw in the demo system (http://dev.jqueryui.com/ticket/4375), ignore!
		$( "#dialog:ui-dialog" ).dialog( "destroy" );

		$( "#dialog-message" ).dialog({
			modal: true,
            autoOpen: false,
            height: 400,
            width: 600,
			buttons: {
				Ok: function() {
					$( this ).dialog( "close" );
				}
			}
		});
	});
       $(function() {
		// a workaround for a flaw in the demo system (http://dev.jqueryui.com/ticket/4375), ignore!
		$( "#dialog:ui-dialog" ).dialog( "destroy" );

		$( "#dialog-transaction-list" ).dialog({
			modal: true,
            autoOpen: false,
            height: 400,
            width: 600,
			buttons: {
				Ok: function() {
					$( this ).dialog( "close" );
				}
			}
		});
	});
           $(function() {
		// a workaround for a flaw in the demo system (http://dev.jqueryui.com/ticket/4375), ignore!
		$( "#dialog:ui-dialog" ).dialog( "destroy" );

		$( "#dialog-transaction" ).dialog({
			modal: true,
            autoOpen: false,
            height: 100,
            width: 400,
			buttons: {
				Ok: function() {
                    $('#orderForm').submit();
					$( this ).dialog( "close" );
				},
                Cancel: function() {
					$( this ).dialog( "close" );
				}

			}
		});
	});
function getHistory(order_id){
                                url = "/history/"+order_id+"/";
                                $.getJSON(url, function(result)
                                {
                                    $('#historyList').html('');

                                    var userArray = result.users;
                                    var dateArray = result.dates;
                                    var statusArray = result.statuses;
                                    $('#historyList').append('<thead class="fixedHeader"><tr class="alternateRow"><th>User</th><th>Status</th><th>Date</th></tr></thead>');

                                    for (var i = 0; i < userArray.length; i++) {
                                          $('#historyList').append('<tr><td>'+ userArray[i] +' has changed status to </td><td>'+ statusArray[i] +'</td><td> on '+ dateArray[i] + '</td></tr>');
//                                        alert(statusArray[i]);
                                       }

//                                    $('#userList').html(result.users);
                                });
                }
function openDialog(order_id){

         getHistory(order_id);
       	$( "#dialog-message" ).dialog( "open" );
}
function openSearch(){
       	$( "#dialog-form" ).dialog( "open" );
}

function getTransactionList(){
                                url = "/transactions";
                                $.getJSON(url, function(result)
                                {
                                    $('#transactionList').html('');

                                    var tr_string = result.tr_string;
                                    var dateArray = result.dates;

                                    $('#transactionList').append('<thead class="fixedHeader"><tr class="alternateRow"><th>Transaction String</th><th>Date</th></tr></thead>');
                                    for (var i = 0; i < tr_string.length; i++) {
                                         $('#transactionList').append('<tr><td><a href="/orders/transactions/?transaction_keyword='+ tr_string[i] +'">'+ tr_string[i] + '</a></td><td>'+ dateArray[i] + '</td></tr>');
//                                         $('#transactionList').append('<tr><td>'+ tr_string[i] +'</td><td>'+ dateArray[i] + '</td></tr>');
                                       }
                                });
}
function openTransactionList(){

                getTransactionList();
                  $( "#dialog-transaction-list" ).dialog( "open" );
       }
function transactionDialog(){

//        $('#statusForDialog').append('<tr><td>'+ $('#statuslist').val() + '</td></tr>');
        if($('#statuslist').val() == 'supplier_informed')
        {
            $( "#dialog-transaction" ).dialog( "open" );
        }
        else
        {
            $('#orderForm').submit();
        }
}
$(document).ready(function(){
    $('.checkboxClass:button').toggle(function(){
        $('input:checkbox').attr('checked','checked');
        $(this).val('uncheck all')
    },function(){
        $('input:checkbox').removeAttr('checked');
        $(this).val('check all');
    })
})

             </script>
</head>
<body>


    {% block baseBody %}

    {% endblock %}




</body>
</html>